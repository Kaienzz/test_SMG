# ゲームコンセプト・要件定義書
# test_smg (Simple Management Game)

## プロジェクト概要

**プロジェクト名**: test_smg (Simple Management Game)  
**ジャンル**: ブラウザベース ターン制RPG  
**開発言語**: PHP (Laravel 12.x)  
**作成日**: 2025年7月25日  
**版数**: Version 1.0  

---

## 1. ゲームコンセプト

### 1.1 基本コンセプト
「**昔懐かしいCGIゲームの操作感を現代的なUIデザインで表現したシンプルなWebゲーム**」

- **レトロ感**: 2000年代前半のCGI型ブラウザゲームの操作感を再現
- **モダンUI**: Apple Human Interface Guidelines準拠の現代的なデザイン
- **シンプルさ**: 複雑な操作を排除した直感的なゲームプレイ
- **アクセシビリティ**: ブラウザさえあれば誰でも楽しめる手軽さ

### 1.2 ゲームの世界観
- **ファンタジー世界**: 剣と魔法の世界設定
- **冒険者**: プレイヤーは一人の冒険者として町と道路を移動
- **サイコロ要素**: 移動や戦闘にサイコロを使った運要素を導入
- **成長システム**: スキルベースのキャラクター成長

### 1.3 ターゲットユーザー
- **メインターゲット**: 25-40歳のレトロゲーム愛好者
- **サブターゲット**: 手軽にゲームを楽しみたいライトゲーマー
- **期待プレイ時間**: 1セッション 10-30分程度
- **プレイスタイル**: スキマ時間での気軽なプレイ

---

## 2. 主要機能要件

### 2.1 ゲームシステム

#### 2.1.1 移動システム
- **サイコロ移動**: 2-3個のサイコロによる確率的移動
- **位置システム**: 道路上0-100の位置管理
- **場所切り替え**: 町↔道路間のスムーズな移動
- **エンカウント**: 移動時のランダムモンスター出現

#### 2.1.2 戦闘システム
- **ターン制戦闘**: 攻撃・防御・逃走・スキル使用
- **ダメージ計算**: 物理攻撃・魔法攻撃・クリティカル判定
- **戦闘AI**: シンプルなモンスターAI
- **勝敗処理**: 経験値・アイテム獲得

#### 2.1.3 キャラクター成長
- **スキルベースレベル**: 総スキルレベル÷10+1
- **複数スキル**: 移動系・採集系・戦闘系スキル
- **ステータス**: HP/MP/SP + 攻撃・防御・素早さ等
- **装備システム**: 武器・防具による能力値変化

#### 2.1.4 アイテム・インベントリ
- **スロット制**: 20スロットのインベントリ管理
- **レアリティ**: 6段階のアイテムレアリティ
- **装備可能**: 武器・防具・アクセサリー装備
- **消耗品**: ポーション・回復アイテム使用

#### 2.1.5 ショップ・経済
- **複数ショップ**: アイテムショップ・鍛冶屋
- **売買システム**: アイテム購入・売却
- **価格変動**: レアリティ・需要による価格設定
- **在庫管理**: ショップごとの商品管理

#### 2.1.6 採集・クラフティング
- **採集システム**: 道路でのアイテム採集
- **成功率**: スキルレベル・アイテムレアリティ依存
- **資源管理**: 採集アイテムの管理
- **SP消費**: スキル使用によるSP管理

### 2.2 ユーザーインターフェース

#### 2.2.1 画面設計
- **レスポンシブ**: モバイル・タブレット・PC対応
- **単一画面**: ページ遷移を最小限に抑制
- **動的UI**: JavaScriptによる画面切り替え
- **視覚的フィードバック**: ホバー・アニメーション効果

#### 2.2.2 操作性
- **ワンクリック操作**: 複雑な操作の排除
- **キーボード対応**: 矢印キー・エンターキー対応
- **ドラッグ&ドロップ**: インベントリアイテム移動
- **アクセシビリティ**: WCAG準拠のUI設計

#### 2.2.3 デザインシステム
- **Modern Light Theme**: Apple準拠のライトテーマ
- **統一カラーパレット**: システムカラー使用
- **一貫したコンポーネント**: ボタン・カード・フォーム
- **CGI風要素**: レトロ感を演出する要素配置

---

## 3. 技術要件

### 3.1 システム構成

#### 3.1.1 バックエンド
- **フレームワーク**: Laravel 12.x (PHP 8.2+)
- **アーキテクチャ**: MVC + Service Layer + Domain Layer
- **認証**: Laravel Breeze
- **データベース**: SQLite (開発) / PostgreSQL (本番)

#### 3.1.2 フロントエンド
- **JavaScript**: Vanilla JS (ES2020+)
- **CSS**: Tailwind CSS + カスタムCSS
- **テンプレート**: Blade Engine
- **ビルドツール**: Vite

#### 3.1.3 データストレージ
- **データベース**: Eloquent ORM
- **セッション**: Laravel Session (開発時は一部セッション管理)
- **キャッシュ**: Redis/Memcached (本番環境)
- **ファイルストレージ**: Local Storage (開発) / AWS S3 (本番)

### 3.2 パフォーマンス要件

#### 3.2.1 レスポンスタイム
- **画面表示**: 初回表示 < 2秒
- **AJAX通信**: API応答 < 500ms
- **データベース**: クエリ実行 < 200ms
- **静的ファイル**: 画像・CSS・JS読み込み < 1秒

#### 3.2.2 同時接続
- **想定同時接続数**: 100ユーザー (初期)
- **拡張性**: 1,000ユーザーまでスケール可能
- **セッション管理**: 効率的なセッション処理
- **リソース消費**: メモリ使用量最適化

#### 3.2.3 可用性
- **稼働率**: 99.5% 以上
- **バックアップ**: 日次データバックアップ
- **障害対応**: 24時間以内の復旧
- **監視**: エラーログ・パフォーマンス監視

### 3.3 セキュリティ要件

#### 3.3.1 認証・認可
- **ユーザー認証**: Laravel Breeze による認証
- **セッション管理**: CSRF トークン管理
- **パスワード**: ハッシュ化保存
- **権限管理**: ロールベースアクセス制御

#### 3.3.2 データ保護
- **入力検証**: バリデーション処理
- **SQLインジェクション**: Eloquent ORM使用
- **XSS対策**: Blade テンプレート自動エスケープ
- **機密データ**: 暗号化保存

#### 3.3.3 ゲーム固有セキュリティ
- **チート対策**: サーバーサイド検証
- **データ整合性**: ゲーム状態の整合性チェック
- **不正操作**: 異常なAPI呼び出し検出
- **セーブデータ**: データ改ざん防止

---

## 4. 非機能要件

### 4.1 スケーラビリティ
- **水平スケーリング**: ロードバランサー対応
- **データベーススケーリング**: マスター・スレーブ構成
- **CDN対応**: 静的ファイル配信最適化
- **マイクロサービス**: 将来的な機能分離

### 4.2 メンテナビリティ
- **コード品質**: PSR-4準拠・テスト可能性
- **ドキュメント**: 包括的な仕様書整備
- **バージョン管理**: Git による変更履歴管理
- **デプロイ**: CI/CD パイプライン構築

### 4.3 ユーザビリティ
- **学習コスト**: 10分以内でゲーム理解
- **操作性**: 3クリック以内で主要機能到達
- **エラーハンドリング**: 分かりやすいエラーメッセージ
- **ヘルプ**: コンテキストヘルプ機能

### 4.4 互換性
- **ブラウザ対応**: Chrome 90+, Firefox 88+, Safari 14+
- **モバイル対応**: iOS Safari, Android Chrome
- **画面サイズ**: 320px～1920px対応
- **アクセシビリティ**: WCAG 2.1 AA準拠

---

## 5. システム制約

### 5.1 技術制約
- **PHP版数**: PHP 8.2以上必須
- **Laravel版数**: Laravel 12.x系使用
- **データベース**: SQLite (開発) / PostgreSQL (本番)
- **ブラウザ依存**: JavaScript必須・Cookie有効必須

### 5.2 運用制約
- **保守時間**: 週次メンテナンス 1時間以内
- **バックアップ**: 日次バックアップ必須
- **ログ保存**: 3ヶ月間ログ保存
- **データ移行**: ユーザーデータ無損失移行

### 5.3 開発制約
- **開発期間**: 段階的リリース (MVP → 機能追加)
- **リソース**: AI支援開発活用
- **品質**: 自動テスト・静的解析必須
- **ドキュメント**: 仕様書常時更新

---

## 6. 想定リスク・課題

### 6.1 技術リスク
- **パフォーマンス**: 大量データ処理時の性能劣化
- **セキュリティ**: チート・改ざん行為への対応
- **互換性**: 新ブラウザ版数での動作確認
- **依存関係**: Laravel・PHP版数アップデート対応

### 6.2 運用リスク
- **サーバー障害**: インフラ障害時の影響範囲
- **データ損失**: バックアップ・復旧手順の確立
- **トラフィック急増**: 予想以上のアクセス集中
- **法的対応**: GDPR等データ保護規制への準拠

### 6.3 ビジネスリスク
- **ユーザー離脱**: ゲームバランス・飽きによる離脱
- **競合出現**: 類似ゲームとの差別化
- **収益化**: 将来的な収益モデル構築
- **コミュニティ**: ユーザーコミュニティ形成

---

## 7. 成功指標・KPI

### 7.1 技術指標
- **稼働率**: 99.5%達成
- **レスポンス時間**: 平均500ms以下
- **エラー率**: 0.1%以下
- **テストカバレッジ**: 80%以上

### 7.2 ユーザー指標
- **MAU (月間アクティブユーザー)**: 1,000ユーザー
- **セッション時間**: 平均20分
- **継続率**: 7日継続率 50%以上
- **機能利用率**: 全機能平均利用率 60%以上

### 7.3 開発指標
- **リリース頻度**: 月次機能リリース
- **バグ修正時間**: 平均24時間以内
- **新機能開発**: 要件定義から2週間以内
- **ドキュメント更新**: リリース同期100%

---

## 8. 開発ロードマップ

### 8.1 Phase 1: MVP (Minimum Viable Product)
- **基本移動システム**: サイコロ移動・場所移動
- **簡易戦闘**: 基本的な戦闘システム
- **キャラクター管理**: ステータス表示・管理
- **基本UI**: 町・道路画面

### 8.2 Phase 2: 機能拡張
- **インベントリ**: アイテム管理・使用
- **装備システム**: 武器・防具装備
- **ショップ**: アイテム売買
- **スキルシステム**: スキル使用・成長

### 8.3 Phase 3: 品質向上
- **採集システム**: 道路での採集機能
- **UI/UX改善**: デザインシステム統一
- **パフォーマンス最適化**: 処理速度向上
- **テスト強化**: 自動テスト実装

### 8.4 Phase 4: 拡張機能
- **認証システム**: ユーザー登録・ログイン
- **データ永続化**: セッション→データベース移行
- **新コンテンツ**: 新エリア・モンスター追加
- **ソーシャル機能**: ランキング・チャット

---

## 9. 現在の実装状況

### 9.1 完成済み機能
✅ **移動システム**: サイコロ移動・位置管理・場所切り替え  
✅ **戦闘システム**: 基本戦闘・ダメージ計算・勝敗処理  
✅ **キャラクター管理**: ステータス表示・HP/MP/SP管理  
✅ **UI基盤**: 町・道路画面・レスポンシブ対応  
✅ **採集システム**: 道路での採集・アイテム取得  
✅ **インベントリ**: アイテム管理・使用・移動  
✅ **装備システム**: 武器・防具装備・効果反映  
✅ **ショップ**: アイテムショップ・鍛冶屋  
✅ **スキルシステム**: スキル使用・効果適用  

### 9.2 部分実装機能
🟡 **データベース**: モデル定義済み・一部セッション管理  
🟡 **認証システム**: Laravel Breeze導入済み・未統合  
🟡 **テストシステム**: テストファイル存在・テスト未充実  

### 9.3 未実装機能
❌ **データ永続化**: セッション→データベース完全移行  
❌ **リアルタイム機能**: WebSocket・通知システム  
❌ **管理画面**: ゲームマスター用管理機能  

---

## 10. 品質保証・テスト戦略

### 10.1 テスト種類
- **Unit Test**: モデル・サービス層テスト
- **Feature Test**: Controller・API機能テスト
- **Browser Test**: E2E シナリオテスト
- **Performance Test**: 負荷・ストレステスト

### 10.2 テスト環境
- **開発環境**: 開発者ローカル環境
- **テスト環境**: CI/CD自動テスト環境
- **ステージング**: 本番同等環境でのテスト
- **本番環境**: 本番リリース前テスト

### 10.3 品質指標
- **テストカバレッジ**: 80%以上
- **静的解析**: PHPStan Level 8
- **コードスタイル**: PSR-12準拠
- **セキュリティ**: Laravel Security Checker

---

この要件定義書は、test_smgプロジェクトの開発指針として機能し、開発チーム・ステークホルダー間の共通理解を促進することを目的としています。

**最終更新**: 2025年7月25日  
**承認**: 開発チーム  
**次回レビュー**: Phase完了時